# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é —Å PM2 –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ

- **IP:** 45.141.78.168
- **–ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:** PM2
- **–ë–µ–∑ Docker**

---

## ‚úÖ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:

- ‚úÖ Node.js (v18 –∏–ª–∏ –≤—ã—à–µ)
- ‚úÖ npm –∏–ª–∏ pnpm
- ‚úÖ PM2
- ‚úÖ Git (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üìù –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

### 1.1 –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –¥–ª—è backend

–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `backend/` —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:

```bash
# –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
PORT=3001

# URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –¥–ª—è CORS
FRONTEND_URL=http://45.141.78.168

# –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ó–ê–ú–ï–ù–ò–¢–ï!)
JWT_SECRET=–≤–∞—à_—Å—É–ø–µ—Ä_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á_–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞

# –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
NODE_ENV=production
```

**–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å JWT_SECRET:**

```powershell
# Windows PowerShell
$bytes = New-Object byte[] 32
(New-Object Security.Cryptography.RNGCryptoServiceProvider).GetBytes($bytes)
[Convert]::ToBase64String($bytes)
```

### 1.2 –°–æ–∑–¥–∞–π—Ç–µ .env.local –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–µ—Å–ª–∏ –Ω–µ—Ç)

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ `.env.local`:

```bash
NEXT_PUBLIC_API_URL=http://45.141.78.168:3001/api
```

---

## üì§ –®–∞–≥ 2: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ Git (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@45.141.78.168

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /opt

# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)
git clone <–≤–∞—à-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π> asian-goods-store
cd asian-goods-store

# –ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
cd /opt/asian-goods-store
git pull origin main
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ SCP/FTP

**–° –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (Windows PowerShell):**

```powershell
# –°–æ–∑–¥–∞–π—Ç–µ –∞—Ä—Ö–∏–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å tar)
tar -czf deploy.tar.gz `
    --exclude=node_modules `
    --exclude=.next `
    --exclude=backend/node_modules `
    --exclude=backend/uploads `
    --exclude=backend/database/store.db `
    --exclude=.git `
    *

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp deploy.tar.gz root@45.141.78.168:/opt/asian-goods-store/

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Ä–∞—Å–ø–∞–∫—É–π—Ç–µ
ssh root@45.141.78.168
cd /opt/asian-goods-store
tar -xzf deploy.tar.gz
rm deploy.tar.gz
```

**–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:**

```powershell
.\deploy-to-server-pm2.ps1
```

---

## üîß –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@45.141.78.168

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/asian-goods-store

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
npm install
# –∏–ª–∏
pnpm install

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –±—ç–∫–µ–Ω–¥–∞
cd backend
npm install
cd ..

# –°–æ–±–µ—Ä–∏—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è production
npm run build
```

---

## üöÄ –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ —Å PM2

### 4.1 –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ª–æ–≥–æ–≤

```bash
mkdir -p logs
```

### 4.2 –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è ecosystem.config.js
pm2 start ecosystem.config.js

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é
pm2 start backend/server.js --name "asian-goods-backend" --time
pm2 start npm --name "asian-goods-frontend" -- start
```

### 4.3 –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PM2

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
pm2 save

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
pm2 startup
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä—É—é PM2 –ø—Ä–µ–¥–ª–æ–∂–∏—Ç
```

---

## üìä –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 5.1 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

```bash
pm2 status
# –∏–ª–∏
pm2 ls
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –æ–±–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ —Å—Ç–∞—Ç—É—Å–µ "online":
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id  ‚îÇ name                      ‚îÇ status  ‚îÇ cpu     ‚îÇ mem  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0   ‚îÇ asian-goods-backend       ‚îÇ online  ‚îÇ 0%      ‚îÇ 50MB ‚îÇ
‚îÇ 1   ‚îÇ asian-goods-frontend      ‚îÇ online  ‚îÇ 0%      ‚îÇ 80MB ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 5.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
# –í—Å–µ –ª–æ–≥–∏
pm2 logs

# –¢–æ–ª—å–∫–æ backend
pm2 logs asian-goods-backend

# –¢–æ–ª—å–∫–æ frontend
pm2 logs asian-goods-frontend

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
pm2 logs --lines 100
```

### 5.3 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API

```bash
# Health check
curl http://localhost:3001/api/health

# –ò–ª–∏ —Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
curl http://45.141.78.168:3001/api/health
```

### 5.4 –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

- **–°–∞–π—Ç:** http://45.141.78.168:3000
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:** http://45.141.78.168:3000/admin
- **API:** http://45.141.78.168:3001/api/health

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ß—Ç–æ–±—ã —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–ª –Ω–∞ –ø–æ—Ä—Ç—É 80 (–±–µ–∑ :3000):

### 6.1 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

```bash
sudo apt update
sudo apt install nginx -y
```

### 6.2 –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
sudo nano /etc/nginx/sites-available/asian-goods
```

–í—Å—Ç–∞–≤—å—Ç–µ:

```nginx
server {
    listen 80;
    server_name 45.141.78.168;

    client_max_body_size 20M;

    # API –ø—Ä–æ–∫—Å–∏
    location /api/ {
        proxy_pass http://localhost:3001/api/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã backend (uploads)
    location /uploads/ {
        alias /opt/asian-goods-store/backend/uploads/;
    }

    # Frontend
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }

    # Next.js —Å—Ç–∞—Ç–∏–∫–∞
    location /_next/ {
        proxy_pass http://localhost:3000/_next/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
    }
}
```

### 6.3 –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫—É—é —Å—Å—ã–ª–∫—É
sudo ln -s /etc/nginx/sites-available/asian-goods /etc/nginx/sites-enabled/

# –£–¥–∞–ª–∏—Ç–µ –¥–µ—Ñ–æ–ª—Ç–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo rm /etc/nginx/sites-enabled/default

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx
sudo systemctl restart nginx

# –í–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
sudo systemctl enable nginx
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–∞–π—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: **http://45.141.78.168** (–±–µ–∑ –ø–æ—Ä—Ç–∞)

---

## ü§ñ –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞

### 7.1 –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram ‚Üí [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ: `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω

### 7.2 –ü–æ–ª—É—á–∏—Ç–µ Chat ID

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram ‚Üí [@userinfobot](https://t.me/userinfobot)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à Chat ID

### 7.3 –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ: http://45.141.78.168/admin (–∏–ª–∏ http://45.141.78.168:3000/admin)
2. –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram"**
4. –í–≤–µ–¥–∏—Ç–µ:
   - **Bot Token**
   - **Chat ID**
   - **–í–∫–ª—é—á–∏—Ç—å**: ‚úÖ
5. –ù–∞–∂–º–∏—Ç–µ **"–¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"**
6. –ï—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ ‚Üí **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Git

```bash
ssh root@45.141.78.168
cd /opt/asian-goods-store

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å)
npm install
cd backend && npm install && cd ..

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 restart all

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs --lines 50
```

### –°–ø–æ—Å–æ–± 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç

**–° –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞:**

```powershell
.\deploy-to-server-pm2.ps1
```

---

## üìã –ü–æ–ª–µ–∑–Ω—ã–µ PM2 –∫–æ–º–∞–Ω–¥—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 status
pm2 ls

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
pm2 show asian-goods-backend

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart all
pm2 restart asian-goods-backend
pm2 restart asian-goods-frontend

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 stop all
pm2 stop asian-goods-backend

# –ó–∞–ø—É—Å–∫
pm2 start all
pm2 start asian-goods-backend

# –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞
pm2 delete asian-goods-backend
pm2 delete all

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å 0 downtime
pm2 reload all
```

### –õ–æ–≥–∏

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
pm2 logs asian-goods-backend

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ N —Å—Ç—Ä–æ–∫
pm2 logs --lines 100

# –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
pm2 flush

# –§–∞–π–ª—ã –ª–æ–≥–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤
ls -la logs/
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 monit

# –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
pm2 plus
```

### –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 save

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã
pm2 startup

# –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
pm2 unstartup
```

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs asian-goods-backend --lines 100

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª
cat backend/.env

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç
netstat -tlnp | grep 3001
# –∏–ª–∏
ss -tlnp | grep 3001

# –ï—Å–ª–∏ –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç - –Ω–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å
lsof -i :3001
# –£–±–µ–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å
kill -9 <PID>

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
pm2 restart asian-goods-backend
```

### Frontend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–±–æ—Ä–∫—É
npm run build

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs asian-goods-frontend --lines 100

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env.local
cat .env.local

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
npm run build
pm2 restart asian-goods-frontend
```

### Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
psql -h localhost -U postgres -d magazin

# –í PostgreSQL:
SELECT * FROM telegram_settings;
\q

# –ò–ª–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
psql -h localhost -U postgres -d magazin -c "SELECT * FROM telegram_settings;"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs asian-goods-backend | grep -i telegram

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend
pm2 restart asian-goods-backend
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
pm2 status

# –£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç –≤ ecosystem.config.js
# max_memory_restart: '1G'

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
pm2 restart all
```

---

## üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç
sudo nano /root/backup-db.sh
```

–í—Å—Ç–∞–≤—å—Ç–µ:

```bash
#!/bin/bash
BACKUP_DIR="/backup/asian-goods"
DATE=$(date +%Y%m%d_%H%M%S)
mkdir -p $BACKUP_DIR

# PostgreSQL backup
PGHOST=${PGHOST:-localhost}
PGPORT=${PGPORT:-5432}
PGDATABASE=${PGDATABASE:-magazin}
PGUSER=${PGUSER:-postgres}

pg_dump -h $PGHOST -p $PGPORT -U $PGUSER -d $PGDATABASE -F c -f "$BACKUP_DIR/backup_${DATE}.dump"

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ backup'—ã (—Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π)
find $BACKUP_DIR -name "backup_*.dump" -mtime +7 -delete

echo "Backup created: $BACKUP_DIR/backup_${DATE}.dump"
```

–°–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:

```bash
chmod +x /root/backup-db.sh
```

–î–æ–±–∞–≤—å—Ç–µ –≤ cron:

```bash
crontab -e
```

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É (backup –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00):

```
0 2 * * * /root/backup-db.sh >> /var/log/asian-goods-backup.log 2>&1
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Firewall

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –ø–æ—Ä—Ç—ã
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 80/tcp    # HTTP
sudo ufw allow 443/tcp   # HTTPS (–¥–ª—è –±—É–¥—É—â–µ–≥–æ SSL)

# –ï—Å–ª–∏ –Ω–µ—Ç Nginx, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
sudo ufw allow 3000/tcp
sudo ufw allow 3001/tcp

# –í–∫–ª—é—á–∏—Ç–µ firewall
sudo ufw enable

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
sudo ufw status
```

### –ó–∞—â–∏—Ç–∏—Ç–µ .env —Ñ–∞–π–ª—ã

```bash
chmod 600 backend/.env
chmod 600 .env.local
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
pm2 monit

# –ò–ª–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
watch -n 2 'pm2 status && echo "" && free -h && df -h'

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs --lines 50
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- [ ] –ö–æ–¥ –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] –§–∞–π–ª `backend/.env` —Å–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] JWT_SECRET —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (npm install)
- [ ] Backend –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] Frontend —Å–æ–±—Ä–∞–Ω (npm run build)
- [ ] PM2 –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—â–µ–Ω—ã
- [ ] PM2 —Å–æ—Ö—Ä–∞–Ω–µ–Ω (pm2 save)
- [ ] PM2 –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (pm2 startup)
- [ ] Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Telegram –±–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ backup'—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–í–∞—à –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å PM2!

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- üåê –°–∞–π—Ç: http://45.141.78.168 (–∏–ª–∏ :3000)
- üîß –ê–¥–º–∏–Ω: http://45.141.78.168/admin
- üìã API: http://45.141.78.168:3001/api/health
- üì± Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:**

```bash
# SSH
ssh root@45.141.78.168

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç
cd /opt/asian-goods-store

# –°—Ç–∞—Ç—É—Å
pm2 status

# –õ–æ–≥–∏
pm2 logs

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart all
```

